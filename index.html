<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COPPERMIND | Operational Intelligence Platform</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* --- Enterprise Theme Variables --- */
        :root {
            --bg-app: #0f172a;
            --bg-panel: #1e293b;
            --bg-hover: #334155;
            --border-color: #334155;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --accent-brand: #3b82f6;
            --accent-alert: #ef4444;
            --accent-warning: #f59e0b;
            --accent-success: #10b981;
            --font-stack: 'Inter', sans-serif;
        }

        * { box-sizing: border-box; }
        body { margin: 0; font-family: var(--font-stack); background-color: var(--bg-app); color: var(--text-primary); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* Navigation */
        .top-nav { height: 56px; background: var(--bg-panel); border-bottom: 1px solid var(--border-color); display: flex; align-items: center; justify-content: space-between; padding: 0 24px; }
        .brand { font-size: 1.1rem; font-weight: 700; letter-spacing: 1px; display: flex; gap: 10px; align-items: center; }
        .brand span { background: var(--accent-brand); font-size: 0.7rem; padding: 2px 6px; border-radius: 4px; }
        
        .app-body { flex: 1; display: flex; overflow: hidden; }
        
        /* Sidebar */
        .sidebar { width: 50px; background: var(--bg-panel); border-right: 1px solid var(--border-color); display: flex; flex-direction: column; align-items: center; padding-top: 20px; gap: 24px; }
        .sidebar-icon { color: var(--text-muted); cursor: pointer; transition: 0.2s; }
        .sidebar-icon:hover, .sidebar-icon.active { color: var(--accent-brand); }

        /* Main Area */
        .main-canvas { flex: 1; padding: 32px; overflow-y: auto; position: relative; }

        /* Dashboard View */
        .kpi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px; margin-bottom: 32px; }
        .kpi-card { background: var(--bg-panel); border: 1px solid var(--border-color); padding: 20px; border-radius: 6px; }
        .kpi-value { font-size: 1.8rem; font-weight: 700; margin-top: 10px; font-family: 'Roboto Mono'; }
        .kpi-label { color: var(--text-secondary); font-size: 0.85rem; font-weight: 500; }
        
        .alert-item { background: var(--bg-panel); border: 1px solid var(--border-color); border-left: 4px solid var(--accent-alert); padding: 16px 24px; border-radius: 6px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: 0.2s; }
        .alert-item:hover { transform: translateX(5px); background: var(--bg-hover); }

        /* Incident View */
        .incident-layout { display: none; height: 100%; grid-template-columns: 320px 1fr 360px; gap: 24px; }
        .panel { background: var(--bg-panel); border: 1px solid var(--border-color); border-radius: 6px; display: flex; flex-direction: column; overflow: hidden;}
        .panel-header { padding: 16px; border-bottom: 1px solid var(--border-color); font-weight: 600; font-size: 0.95rem; display: flex; justify-content: space-between; align-items: center;}
        .panel-body { padding: 20px; flex: 1; overflow-y: auto; }

        .data-grid { display: grid; grid-template-columns: 100px 1fr; gap: 12px; font-size: 0.9rem; align-items: baseline; }
        .label { color: var(--text-secondary); }
        .value { font-weight: 600; }
        .tag { padding: 2px 8px; border-radius: 12px; font-size: 0.75rem; font-weight: 600; background: rgba(245, 158, 11, 0.2); color: var(--accent-warning); }

        /* GRAPH VISUALIZATION */
        .ontology-canvas {
            background: #131c2e; position: relative; flex: 1; 
            background-image: radial-gradient(#334155 1px, transparent 1px); background-size: 24px 24px;
            overflow: hidden;
        }

        .view-controls {
            position: absolute; top: 16px; right: 16px; z-index: 10; display: flex; gap: 8px;
        }
        .control-btn {
            background: rgba(15, 23, 42, 0.8); border: 1px solid var(--border-color); color: var(--text-secondary);
            padding: 6px 12px; border-radius: 4px; font-size: 0.8rem; cursor: pointer; transition: 0.2s;
            display: flex; align-items: center; gap: 6px;
        }
        .control-btn:hover, .control-btn.active { background: var(--accent-brand); color: white; border-color: var(--accent-brand); }

        /* Nodes */
        .entity-node {
            background: var(--bg-panel); border: 2px solid var(--border-color); padding: 12px; border-radius: 8px;
            position: absolute; width: 160px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); z-index: 2;
        }
        .entity-type { font-size: 0.65rem; text-transform: uppercase; color: var(--text-secondary); letter-spacing: 0.5px; margin-bottom: 4px; }
        .entity-id { font-weight: 700; font-size: 0.9rem; }
        .entity-meta { font-size: 0.75rem; color: var(--accent-alert); margin-top: 4px; }

        /* Core Nodes Positions */
        .node-demand { top: 30%; left: 40%; border-color: var(--accent-alert); z-index: 5; }
        .node-supply-gap { top: 60%; left: 20%; opacity: 0.6; }
        .node-solution { top: 60%; right: 20%; border-color: var(--accent-success); opacity: 0; transform: translateY(20px); z-index: 5;}

        /* Context Nodes (Hidden by default) */
        .context-node {
            opacity: 0; transform: scale(0.8); border: 1px solid var(--border-color);
            background: rgba(30, 41, 59, 0.8); pointer-events: none;
        }
        .context-node .entity-id { font-size: 0.8rem; }
        
        /* Expanded State */
        .ontology-canvas.expanded .context-node { opacity: 0.5; transform: scale(1); }
        .ontology-canvas.expanded .node-demand { transform: scale(1.1); box-shadow: 0 0 20px rgba(239, 68, 68, 0.2); }
        
        /* Connectors */
        .connector { position: absolute; height: 1px; background: var(--text-secondary); opacity: 0.3; transform-origin: 0 50%; z-index: 1; transition: 0.5s;}
        
        /* Agent Logs & Action */
        .log-container { height: 120px; overflow-y: auto; font-family: 'Roboto Mono'; font-size: 0.8rem; border: 1px solid var(--border-color); padding: 12px; margin-bottom: 16px; background: #0f172a; border-radius: 4px; }
        .log-entry { margin-bottom: 6px; opacity: 0; animation: fadeIn 0.3s forwards; display: flex; gap: 8px;}
        .ts { color: var(--text-muted); } .msg { color: var(--accent-brand); } .success { color: var(--accent-success); }
        
        .action-box { border: 1px solid var(--accent-success); background: rgba(16, 185, 129, 0.05); padding: 16px; border-radius: 6px; opacity: 0.5; pointer-events: none; transition: 0.3s; }
        .action-box.active { opacity: 1; pointer-events: all; }
        .btn-action { width: 100%; background: var(--accent-success); border: none; padding: 12px; color: white; font-weight: 600; border-radius: 4px; cursor: pointer; margin-top: 12px; }
        .btn-action:hover { background: #059669; }

        @keyframes fadeIn { to { opacity: 1; } }
    </style>
</head>
<body>

    <div class="top-nav">
        <div class="brand">COPPERMIND <span>OS</span></div>
        <div style="font-size: 0.85rem; color: var(--text-secondary);">System Status: Operational</div>
    </div>

    <div class="app-body">
        <div class="sidebar">
            <div class="sidebar-icon active">üìä</div>
            <div class="sidebar-icon">üï∏Ô∏è</div>
            <div class="sidebar-icon">‚öôÔ∏è</div>
        </div>

        <div class="main-canvas">
            
            <div id="view-dash">
                <div style="margin-bottom: 24px; font-size: 1.1rem; font-weight: 600;">Executive Overview</div>
                <div class="kpi-grid">
                    <div class="kpi-card"><div class="kpi-label">Vehicles in Port</div><div class="kpi-value">1,240</div></div>
                    <div class="kpi-card"><div class="kpi-label">Today's Deliveries</div><div class="kpi-value">84</div></div>
                    <div class="kpi-card"><div class="kpi-label">SLA Compliance</div><div class="kpi-value" style="color:var(--accent-warning)">92.4%</div></div>
                    <div class="kpi-card" style="border-color: var(--accent-alert);"><div class="kpi-label" style="color:var(--accent-alert)">Risk Exposure</div><div class="kpi-value" style="color:var(--accent-alert)">$450K</div></div>
                </div>

                <div style="margin-bottom: 16px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; font-size: 0.8rem; letter-spacing: 1px;">Critical Alerts</div>
                
                <div class="alert-item" onclick="startIncident()">
                    <div>
                        <div style="font-weight: 600; margin-bottom: 4px; display: flex; align-items: center; gap: 8px;">
                            <span style="width: 8px; height: 8px; background: var(--accent-alert); border-radius: 50%;"></span>
                            SLA BREACH RISK: VIP Client Delivery
                        </div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">Client: Intel CEO | Order #9022 | Missing Component (TCU)</div>
                    </div>
                    <button style="background: transparent; border: 1px solid var(--accent-alert); color: var(--accent-alert); padding: 6px 12px; border-radius: 4px; cursor: pointer;">INVESTIGATE ></button>
                </div>
            </div>

            <div id="view-incident" class="incident-layout">
                
                <div class="panel">
                    <div class="panel-header">Context Data</div>
                    <div class="panel-body">
                        <div class="data-grid">
                            <span class="label">Client:</span> <span class="value">Yossi Cohen</span>
                            <span class="label">Segment:</span> <span class="tag">VIP STRATEGIC</span>
                            <span class="label">Order:</span> <span class="value mono">#9022</span>
                            <span class="label">Vehicle:</span> <span class="value">Audi Q7 Black</span>
                            <span class="label">Status:</span> <span class="value" style="color: var(--accent-alert)">BLOCKED</span>
                            <span class="label">Missing:</span> <span class="value mono">TCU-Unit-X</span>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        Ontology Investigation
                        <div class="view-controls">
                            <button class="control-btn" id="btn-context" onclick="toggleContext()">
                                <span>üï∏Ô∏è</span> Show Full Context
                            </button>
                        </div>
                    </div>
                    <div class="ontology-canvas" id="canvas">
                        <div class="connector" style="width: 120px; top: 40%; left: 28%; transform: rotate(35deg);"></div>
                        <div class="connector sol-conn" style="width: 120px; top: 40%; left: 52%; transform: rotate(145deg); opacity: 0;"></div>

                        <div class="entity-node node-demand">
                            <div class="entity-type">Sales Order</div>
                            <div class="entity-id">VIN #9022</div>
                            <div class="entity-meta">‚ö†Ô∏è Missing TCU</div>
                        </div>

                        <div class="entity-node node-supply-gap">
                            <div class="entity-type">Standard Supply</div>
                            <div class="entity-id">Import (DE)</div>
                            <div class="entity-meta">ETA: 7 Days</div>
                        </div>

                        <div class="entity-node node-solution" id="node-sol">
                            <div class="entity-type" style="color: var(--accent-success)">Inventory Match</div>
                            <div class="entity-id">VIN #8841</div>
                            <div class="entity-meta" style="color: var(--accent-success)">Bonded Warehouse</div>
                        </div>

                        <div class="entity-node context-node" style="top: 10%; left: 10%;">Customer History</div>
                        <div class="entity-node context-node" style="top: 10%; right: 15%;">Credit Limit</div>
                        <div class="entity-node context-node" style="bottom: 15%; left: 40%;">Logistics Partner</div>
                        <div class="entity-node context-node" style="top: 50%; right: 5%;">Service Garage</div>
                        <div class="entity-node context-node" style="top: 80%; left: 10%;">Prev. Orders</div>
                        <div class="entity-node context-node" style="top: 5%; left: 50%;">Marketing Seg.</div>

                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">Autonomous Agent</div>
                    <div class="panel-body">
                        <div class="log-container" id="agent-log"></div>
                        
                        <div class="action-box" id="action-box">
                            <div style="color: var(--accent-success); font-weight: 600; margin-bottom: 8px;">Recommended: VIN SWAP</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 12px;">
                                Swap with VIN #8841 to avoid delay.
                                <br>Financial Impact: <b>+$5,000 Saved</b>
                            </div>
                            <button class="btn-action" onclick="execute()">EXECUTE & SYNC ERP</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        function getTS() { return new Date().toTimeString().split(' ')[0]; }
        
        function log(msg, type='') {
            const container = document.getElementById('agent-log');
            container.innerHTML += `<div class="log-entry"><span class="ts">[${getTS()}]</span> <span class="msg ${type}">${msg}</span></div>`;
            container.scrollTop = container.scrollHeight;
        }

        function startIncident() {
            document.getElementById('view-dash').style.display = 'none';
            document.getElementById('view-incident').style.display = 'grid';
            
            log("Incident detected. Initializing Agent...");
            setTimeout(() => log("Querying ERP for standard supply path..."), 800);
            setTimeout(() => log("Result: Import required (7 days). SLA Breach imminent.", "alert"), 1600);
            setTimeout(() => log("Expanding search to Bonded Warehouses..."), 2400);
            
            setTimeout(() => {
                log("SOLUTION FOUND: VIN #8841 is available.", "success");
                document.getElementById('node-sol').style.opacity = 1;
                document.getElementById('node-sol').style.transform = 'translateY(0)';
                document.querySelector('.sol-conn').style.opacity = 0.5;
            }, 3500);

            setTimeout(() => {
                log("Optimization complete. Action ready.", "success");
                document.getElementById('action-box').classList.add('active');
            }, 4500);
        }

        function toggleContext() {
            const canvas = document.getElementById('canvas');
            const btn = document.getElementById('btn-context');
            canvas.classList.toggle('expanded');
            btn.classList.toggle('active');
        }

        function execute() {
            const btn = document.querySelector('.btn-action');
            btn.innerHTML = "EXECUTING...";
            btn.style.background = "#334155";
            setTimeout(() => {
                btn.innerHTML = "‚úì RESOLVED";
                btn.style.background = "var(--accent-success)";
                alert("ERP Updated: Sales Order #9022 linked to VIN #8841.");
            }, 1500);
        }
    </script>
</body>
</html>